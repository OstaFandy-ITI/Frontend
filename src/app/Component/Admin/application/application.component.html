<div class="main-content">
  <!-- Page Title -->
  <h4 class="mb-3">Handyman Applications</h4>

  <!-- Search and Filter Controls -->
  <div class="d-flex mb-3 gap-3">
    <input 
      type="text" 
      class="form-control" 
      id="searchInput"
      [(ngModel)]="searchTerm"
      (input)="filterApplications()"
      placeholder="Search by name..." 
      style="max-width: 250px;">
    
    <select 
      class="form-select" 
      id="specialtyFilter"
      [(ngModel)]="selectedSpecialty"
      (change)="filterApplications()"
      style="max-width: 250px;">
      <option value="">All Specialties</option>
      <option *ngFor="let specialty of specialties" [value]="specialty">{{ specialty }}</option>
    </select>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="text-center py-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <!-- Applications Table -->
  <div *ngIf="!isLoading" class="table-responsive custom-table">
    <table class="table" id="applicationTable">
      <thead>
        <tr>
          <th (click)="sortBy('fullName')" style="cursor: pointer;">
            Name 
            <i [class]="getSortIcon('fullName')" class="text-white"></i>
          </th>
          <th>Specialty</th>
          <th>National ID</th>
          <th>Address</th>
          <th>Experience</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let application of filteredApplications; trackBy: trackByUserId">
          <td>{{ application.fullName }}</td>
          <td>{{ application.specializationCategory }}</td>
          <td>{{ application.nationalId }}</td>
          <td>{{application.defaultAddressPlace}}</td>
          <td>{{application.experienceYears}}</td>

         
          <td>
            <div class="d-flex gap-2">
              <button 
                class="btn btn-success btn-sm" 
                (click)="approveApplication(application)"
                [disabled]="processingUserId === application.userId"
                title="Approve Application">
                <span *ngIf="processingUserId === application.userId" class="spinner-border spinner-border-sm me-1"></span>
                Accept
              </button>
              <button 
                class="btn btn-danger btn-sm" 
                (click)="rejectApplication(application)"
                [disabled]="processingUserId === application.userId"
                title="Reject Application">
                <span *ngIf="processingUserId === application.userId" class="spinner-border spinner-border-sm me-1"></span>
                Reject
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- No Applications Message -->
    <div *ngIf="filteredApplications.length === 0" class="text-center py-5">
      <i class="bi bi-inbox display-4 text-muted"></i>
      <h5 class="mt-3 text-muted">No Applications Found</h5>
      <p class="text-muted">
        <span *ngIf="searchTerm || selectedSpecialty">Try adjusting your search criteria.</span>
        <span *ngIf="!searchTerm && !selectedSpecialty">No pending handyman applications at the moment.</span>
      </p>
    </div>
  </div>
</div>

<!-- Success/Error Toast -->
<div class="toast-container position-fixed bottom-0 end-0 p-3">
  <div id="actionToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="toast-header">
      <i [class]="toastIcon" class="me-2"></i>
      <strong class="me-auto">{{ toastTitle }}</strong>
      <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
    <div class="toast-body">{{ toastMessage }}</div>
  </div>
</div>
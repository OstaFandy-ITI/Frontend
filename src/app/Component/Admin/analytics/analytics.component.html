<div class="dashboard-container">
  <!-- Header Section -->
  <div class="dashboard-header">
    <h1 class="dashboard-title">Analytics Dashboard</h1>
    <p class="dashboard-subtitle">Comprehensive insights and statistics for your business</p>
  </div>

  <!-- Stats Overview Cards -->
  <div class="stats-overview">
    <div class="stat-card">
      <div class="stat-card-header">
        <h3 class="stat-card-title">Total Services</h3>
        <div class="stat-card-icon">üìä</div>
      </div>
      <p class="stat-card-value">{{ serviceStatsCount || 0 }}</p>
      <p class="stat-card-description">Unique services tracked</p>
    </div>
    
    <div class="stat-card">
      <div class="stat-card-header">
        <h3 class="stat-card-title">Total Bookings</h3>
        <div class="stat-card-icon">üìç</div>
      </div>
      <p class="stat-card-value">{{ bookingStatsTotalBookings || 0 }}</p>
      <p class="stat-card-description">Across all locations</p>
    </div>
    
    <div class="stat-card">
      <div class="stat-card-header">
        <h3 class="stat-card-title">Active Cities</h3>
        <div class="stat-card-icon">üèôÔ∏è</div>
      </div>
      <p class="stat-card-value">{{ bookingLocationStats.length || 0 }}</p>
      <p class="stat-card-description">Cities with bookings</p>
    </div>
  </div>

  <!-- Two-column layout for charts -->
  <div class="dashboard-columns">
    <!-- Service Usage Section -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2 class="section-title">Service Usage Statistics</h2>
      </div>
      
      <div class="section-content">
        <div *ngIf="serviceStatsError" class="alert error-message">
          {{ serviceStatsError }}
        </div>

        <div *ngIf="!serviceUsageStats.length && !serviceStatsError" class="alert loading-message">
          Loading service usage statistics...
        </div>

        <div *ngIf="serviceUsageStats.length > 0">
          <div class="chart-wrapper">
            <h3 class="chart-title">Service Usage Distribution</h3>
            <div class="chart-container">
              <canvas baseChart
                [data]="serviceUsageChartData"
                [type]="serviceUsageChartType"
                [options]="serviceUsageChartOptions">
              </canvas>
            </div>
          </div>

          <div class="data-table">
            <h3 class="table-title">Detailed Service Usage</h3>
            <table>
              <thead>
                <tr>
                  <th>Service ID</th>
                  <th>Service Name</th>
                  <th>Category</th>
                  <th>Usage Count</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let stat of serviceUsageStats">
                  <td>{{ stat.serviceId }}</td>
                  <td>{{ stat.serviceName }}</td>
                  <td>{{ stat.categoryName }}</td>
                  <td>
                    <span class="address-booking-count">{{ stat.usageCount }}</span>
                  </td>
                </tr>
                <tr *ngIf="!serviceUsageStats.length">
                  <td colspan="4">No service usage data available.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Booking Location Section -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2 class="section-title">Booking Location Statistics</h2>
      </div>
      
      <div class="section-content">
        <div *ngIf="bookingStatsError" class="alert error-message">
          {{ bookingStatsError }}
        </div>

        <div *ngIf="!bookingLocationStats.length && !bookingStatsError" class="alert loading-message">
          Loading booking location statistics...
        </div>

        <div *ngIf="bookingLocationStats.length > 0">
          <div class="chart-wrapper">
            <h3 class="chart-title">Bookings by City Distribution</h3>
            <div class="chart-container">
              <canvas baseChart
                [data]="bookingCityChartData"
                [type]="bookingCityChartType"
                [options]="bookingCityChartOptions">
              </canvas>
            </div>
          </div>

          <div class="data-table detailed-bookings">
            <h3 class="table-title">Detailed Bookings by Address</h3>
            <table>
              <thead>
                <tr>
                  <th>City</th>
                  <th>City Bookings</th>
                  <th>Address Details</th>
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let cityStat of bookingLocationStats">
                  <tr>
                    <td>{{ cityStat.city }}</td>
                    <td>
                      <span class="address-booking-count">{{ cityStat.bookingCount }}</span>
                    </td>
                    <td>
                      <ul>
                        <li *ngFor="let addressStat of cityStat.addresses">
                          {{ addressStat.address }}
                          <span class="address-booking-count">{{ addressStat.bookingCount }} bookings</span>
                        </li>
                      </ul>
                    </td>
                  </tr>
                </ng-container>
                <tr *ngIf="!bookingLocationStats.length">
                  <td colspan="3">No booking location data available.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>